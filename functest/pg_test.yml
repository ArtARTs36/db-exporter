databases:
  default:
    driver: postgres
    dsn: $PG_DSN

tasks:
  pg/ddl:
    activities:
      - export: ddl
        out:
          dir: ./out

  pg/custom:
    activities:
      - export: custom
        spec:
          template: '{% for table in schema.Tables %}{{ table.Name.Value }},{% endfor %}'
          output:
            extension: txt
        out:
          dir: ./out

  pg/csv_export:
    activities:
      - export: csv
        spec:
          delimiter: ','
          transform:
            countries:
              - skip_columns:
                  - id
              - rename_columns:
                  name: country_name
        out:
          dir: ./out

  pg/diagram:
    activities:
      - export: diagram
        out:
          dir: ./out

  pg/go-entities:
    activities:
      - export: go-entities
        out:
          dir: ./out

  pg/go-entity-repository:
    activities:
      - export: go-entity-repository
        spec:
          go_module: github.com/project
          entities:
            package: internal/entities
          repositories:
            package: internal/repositories
            container:
              struct_name: "container"
        out:
          dir: ./out

  pg/go-entity-repository_interfaces_external:
    activities:
      - export: go-entity-repository
        spec:
          go_module: github.com/project
          entities:
            package: internal/entitiesa
          repositories:
            interfaces:
              place: with_entity
              with_mocks: true
            package: internal/repositoriesa
            container:
              struct_name: "container"
        out:
          dir: ./out

  pg/go-entity-repository_interfaces_internal:
    activities:
      - export: go-entity-repository
        spec:
          go_module: github.com/project
          entities:
            package: internal/entitiesa
          repositories:
            interfaces:
              place: with_repository
              with_mocks: true
            package: internal/repositoriesa
        out:
          dir: ./out

  pg/grpc-crud:
    activities:
      - export: grpc-crud
        spec:
          package: "org.service"
          options:
            optimize_for: SPEED
        out:
          dir: ./out

  pg/laravel-models_export:
    activities:
      - export: laravel-models
        table_per_file: true
        out:
          dir: ./out

  pg/yaml-fixtures_export:
    activities:
      - export: yaml-fixtures
        out:
          dir: ./out

  pg/yaml-fixtures_import:
    activities:
      - import: yaml-fixtures
        from: ./testdata/pg/yaml-fixtures_import

options:
  print_stat: true
  debug: true
