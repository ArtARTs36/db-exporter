databases:
  default:
    driver: postgres
    dsn: $PG_DSN

tasks:
  pg/ddl:
    activities:
      - format: ddl
        out:
          dir: ./out

  pg/custom:
    activities:
      - format: custom
        spec:
          template: '{% for table in schema.Tables %}{{ table.Name.Value }},{% endfor %}'
          output:
            extension: txt
        out:
          dir: ./out

  pg/csv_export:
    activities:
      - format: csv
        spec:
          delimiter: ','
          transform:
            countries:
              - skip_columns:
                  - id
              - rename_columns:
                  name: country_name
        out:
          dir: ./out

  pg/diagram:
    activities:
      - format: diagram
        spec:
          style:
            font:
              family: courier

            background:
              grid:
                cell_size: 20
        out:
          dir: ./out

  pg/go-entities:
    activities:
      - format: go-entities
        out:
          dir: ./out

  pg/go-entity-repository:
    activities:
      - format: go-entity-repository
        spec:
          go_module: github.com/project
          entities:
            package: internal/entities
          repositories:
            package: internal/repositories
            container:
              struct_name: "container"
        out:
          dir: ./out

  pg/go-entity-repository_interfaces_external:
    activities:
      - format: go-entity-repository
        spec:
          go_module: github.com/project
          entities:
            package: internal/entitiesa
          repositories:
            interfaces:
              place: with_entity
              with_mocks: true
            package: internal/repositoriesa
            container:
              struct_name: "container"
        out:
          dir: ./out

  pg/go-entity-repository_interfaces_internal:
    activities:
      - format: go-entity-repository
        spec:
          go_module: github.com/project
          entities:
            package: internal/entitiesa
          repositories:
            interfaces:
              place: with_repository
              with_mocks: true
            package: internal/repositoriesa
        out:
          dir: ./out

  pg/grpc-crud:
    activities:
      - format: grpc-crud
        spec:
          package: "org.service"
          options:
            optimize_for: SPEED
        out:
          dir: ./out

  pg/grpc-crud-with-all:
    activities:
      - format: grpc-crud
        spec:
          package: "org.service"
          pagination: token
          with:
            google.api.field_behavior: true
            google.api.http:
              path_prefix: '/v1'
            buf.validate.field: true
          options:
            optimize_for: SPEED
        out:
          dir: ./out

  pg/laravel-models_export:
    activities:
      - format: laravel-models
        table_per_file: true
        out:
          dir: ./out

  pg/dbml/all:
    activities:
      - format: dbml
        out:
          dir: ./out

  pg/dbml/per-table:
    activities:
      - format: dbml
        table_per_file: true
        out:
          dir: ./out

options:
  print_stat: true
  debug: true
